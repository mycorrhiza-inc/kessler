FROM python:3.12-bookworm

ENV VIRTUAL_ENV=/usr/local


# use UV
ADD --chmod=755 https://github.com/astral-sh/uv/releases/latest/download/uv-installer.sh /install.sh
# Test to see if resolution is a problem unique 
# RUN wget https://github.com/astral-sh/uv/releases/download/0.1.44/uv-x86_64-unknown-linux-gnu.tar.gz
RUN /install.sh 
RUN rm /install.sh

# Set up working directory and dependencies
WORKDIR /app
COPY requirements.txt /app/requirements.txt

RUN /root/.cargo/bin/uv pip install --no-cache -r requirements.txt 

# expose to docker network
EXPOSE 5505

# CMD ["uvicorn","main:app", "--host", "0.0.0.0", "5505", "--workers", "4"]
CMD ["python" "rag/postgres_example.py"]

